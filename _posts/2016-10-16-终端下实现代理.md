---
layout: post
title: "终端下实现代理"
date: 2016-10-16 08:43:59
image: '/assets/img/'
description:
main-class: "off the wall"
color:
tags:
- proxychains
- tsock
categories:
twitter_text:
introduction:
---

目标：使用tsocks or proxychains实现终端代理翻墙，主要用于代码更新。

__前提：本地已经可以通过某个端口(e.g. 1080)翻墙，下面要做的事只是将终端的命令都通过这个端口送出去。__

注意：1. 如果你是mac，且系统版本高于10.10，必须要关闭SIP。 2. `ping` 命令在测试的时候是无法成功通过代理翻墙的，建议使用 `curl` 测试。

### PART 1: TSOCKS

- INSTALL

ubuntu:

```
$ sudo apt-get install tsocks
```

centos:

```
$ yum install tsocks
```

- 配置

```
$ sudo vim /etc/tsocks.conf
```

内容修改如下：

```
local = 192.168.1.0/255.255.255.0 #local表示本地的网络，也就是不使用socks代理的网络
server = 127.0.0.1 # SOCKS 服务器的 IP
server_type = 5 # SOCKS 服务版本
server_port = 1080 ＃SOCKS 服务使用的端口
```

- 使用

在任何需要代理的命令钱加上 `tsocks` 即可，所有的访问都将通过 1080 端口进出。

```
$ tsocks curl google.com #测试的时候ping命令是不可行的，所以不要用
```

### PART 2: PROXYCHAINS

- INSTALL

mac:

我的系统是`10.12`，需要安装`xcode`先。
或者终端执行

```
$ xcode-select --install
```

install

```
$ brew install proxychains-ng
```

- 配置

```
$ sudo vim /usr/local/etc/proxychains.conf
```

在最后的 `[Proxylist] section` 加上你的代理，同时把不需要的注释掉

```conf
[ProxyList]
# add proxy here ...
# meanwile
# defaults set to "tor"
# socks4    127.0.0.1 9050
socks5  127.0.0.1 1080  # 1080是我的代理端口
```

- 使用

`proxychains4` 加上你的命令

```
$ proxychains4 curl google.com  # 命令太长，建议 alias
```

