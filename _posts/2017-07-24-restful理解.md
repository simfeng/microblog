---
layout: post
title: "理解REST"
date: 2017-07-23 13:54:26
description:
categories:
- rest
- api
---


本文主要回答几个问题：

- 什么是REST
- RESTful API 长什么样子
- 如何设计RESTful API
- 接口安全问题方案

#### 什么是REST

__REST: (Resource) Representational state transfer __, 表现层状态转换。

**Resource** 资源,服务器上每一个资源都对应一个 _uri_, 通过_uri_可以定位到唯一资源(REST定义中省略了这一主语).
**Representational** 表现层,资源的表现形式，如 _HTML XML JSON_.
**State Transfer** 状态转换，资源的状态发生改变，这个通过HTTP协议里的方法实现。

    GET: 获取资源    安全     冪等
    POST: 添加资源   不安全     不冪等
    PUT: 更新或创建资源    不安全     冪等
    PATCH: 更新或创建资源   不安全     不冪等
    DELETE: 删除资源   不安全     冪等
    
    PUT与PATCH的区别：PUT的操作是元子的，更新的是这个资源的所有信息，PATCH则允许你只更新某个资源的部分信息.
    
    为什么PATCH不是冪等的：PATCH只更新资源的部分信息，但是不能保证第一次和第二期请求之间是不是会有其他的请求将这个资源信息修改，所以不能保证冪等性。

把__表现层状态转移__翻译成人话就是：_通过uri定位到服务器资源，资源通过一种表现形式在客户端展示出来，根据客户端访问服务器uri的方法不同，对资源进行不同的操作，资源被修改(即状态发生改变)之后，在客户端的表现形式也发生变化._

#### RESTful API 长什么样子

api地址中只有资源的定位信息，不包含任何操作信息，所有操作通过访问的方法来确定。

    GET http://api.example.com/posts  获取所有的文章
    GET http://api.exmaple.com/posts/1  获取id=1的文章
    GET http://api.exmaple.com/posts/1;2;3  获取id=1;2;3的文章
    POST http://api.example.com/posts  添加新文章
    PUT http://api.example.com/posts/1  更新id=1的文章，如果没有，则创建
    DELETE http://api.example.com/posts/1  删除id=1的文章
    
#### 如何设计RESTful API

知道了RESTful API长什么样子，如何设计它就成了一个模仿的问题，我先说几点我认为重要的。

**api中只包含资源信息，不能包含操作的方法（即动词verbs）**

    # GOOD
    POST http://api.exmaple/posts 添加一篇文章

    # BAD
    GET http://api.example.com/posts/add  add是一个动词

**资源用复数表示**

    # GOOD
    GET http://api.example.com/posts/1  获取id=1的资源

    # BAD
    GET http://api.example.com/post/1  post是单数形式

**添加筛选信息**

    http://api.example.com/posts?limit=10&page=5

**级联资源**

    GET http://api.example.com/posts/1/keys  第一篇文章下的所有关键词
    GET http://api.example.com/posts/1/keys/1  第一篇文章下的id=1的关键词





